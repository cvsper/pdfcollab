{% extends "base.html" %}

{% block title %}User 1 - Complete Form Sections - PDF Collaborator{% endblock %}

{% block content %}
<!-- Enhanced User 1 Interface with 5-Section Form -->
<div class="space-y-8">
    <!-- Header -->
    <div class="flex justify-between items-center">
        <h2 class="text-2xl font-bold text-gray-900">Complete Energy Solutions Application</h2>
        <a href="{{ url_for('dashboard') }}" 
           class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
            Cancel
        </a>
    </div>

    <form method="POST" enctype="multipart/form-data" id="user1Form">
        <!-- Progress Bar -->
        <div class="bg-white shadow sm:rounded-lg overflow-hidden">
            <div class="px-4 py-5 sm:p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg leading-6 font-medium text-gray-900">Application Progress</h3>
                    <span class="text-sm text-gray-500">Section <span id="current-section">1</span> of 5</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 20%"></div>
                </div>
                <div class="flex justify-between mt-2 text-xs text-gray-500">
                    <span>Property Info</span>
                    <span>Energy Info</span>
                    <span>Qualification</span>
                    <span>Authorization</span>
                    <span>Income Affidavit</span>
                </div>
            </div>
        </div>

        <!-- Section 1: Property Information -->
        <div class="section-container bg-white shadow sm:rounded-lg overflow-hidden" id="section-1">
            <div class="px-4 py-5 sm:p-6">
                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Section 1: Property Information (1-4 Units)</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Property Address</label>
                        <input type="text" name="property_address" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Apartment Number</label>
                        <input type="text" name="apartment_number" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">City</label>
                        <input type="text" name="city" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">State</label>
                        <input type="text" name="state" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ZIP Code</label>
                        <input type="text" name="zip_code" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Number of Apartments in Property</label>
                        <input type="number" name="apartments_count" min="1" max="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                
                <div class="mt-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Type of Dwelling</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="dwelling_type" value="single_family" class="mr-2">
                            <span class="text-sm">Single Family Home</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="dwelling_type" value="apartment" class="mr-2">
                            <span class="text-sm">Apartment</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="dwelling_type" value="condominium" class="mr-2">
                            <span class="text-sm">Condominium</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 2: Applicant and Energy Information -->
        <div class="section-container bg-white shadow sm:rounded-lg overflow-hidden hidden" id="section-2">
            <div class="px-4 py-5 sm:p-6">
                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Section 2: Applicant and Energy Information</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
                        <input type="text" name="first_name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
                        <input type="text" name="last_name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Telephone</label>
                        <input type="tel" name="telephone" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" name="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Primary Heating Fuel Type</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="heating_fuel" value="electric" class="mr-2">
                                <span class="text-sm">Electric</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="heating_fuel" value="natural_gas" class="mr-2">
                                <span class="text-sm">Natural Gas</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="heating_fuel" value="oil" class="mr-2">
                                <span class="text-sm">Oil</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="heating_fuel" value="propane" class="mr-2">
                                <span class="text-sm">Propane</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Applicant Is the</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="applicant_type" value="property_owner" class="mr-2">
                                <span class="text-sm">Property Owner</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="applicant_type" value="renter_tenant" class="mr-2">
                                <span class="text-sm">Renter/Tenant</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Electric Utility</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="electric_utility" value="eversource" class="mr-2">
                                <span class="text-sm">Eversource</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="electric_utility" value="ui" class="mr-2">
                                <span class="text-sm">UI</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="electric_utility" value="other" class="mr-2">
                                <span class="text-sm">Other</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Natural Gas Utility</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="gas_utility" value="cng" class="mr-2">
                                <span class="text-sm">CNG</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="gas_utility" value="eversource" class="mr-2">
                                <span class="text-sm">Eversource</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="gas_utility" value="scg" class="mr-2">
                                <span class="text-sm">SCG</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Electric Account Number</label>
                        <input type="text" name="electric_account" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Gas Account Number</label>
                        <input type="text" name="gas_account" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 3: Applicant Qualification Information -->
        <div class="section-container bg-white shadow sm:rounded-lg overflow-hidden hidden" id="section-3">
            <div class="px-4 py-5 sm:p-6">
                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Section 3: Applicant Qualification Information</h3>
                
                <div class="space-y-6">
                    <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-md">
                        <p class="text-sm text-yellow-800">Please select one of the four qualification options below and provide the required information.</p>
                    </div>

                    <!-- Option A -->
                    <div class="border border-gray-200 rounded-md p-4">
                        <label class="flex items-start">
                            <input type="radio" name="qualification_option" value="option_a" class="mr-3 mt-1">
                            <div>
                                <span class="font-medium text-gray-900">Option A: Enrolled in utility programs</span>
                                <div class="mt-2 space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="utility_program" value="electric_discount" class="mr-2">
                                        <span class="text-sm">Electric Discount Rate</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="utility_program" value="matching_payment" class="mr-2">
                                        <span class="text-sm">Matching Payment Program</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="utility_program" value="low_income_discount" class="mr-2">
                                        <span class="text-sm">Low-Income Discount Rate</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="utility_program" value="bill_forgiveness" class="mr-2">
                                        <span class="text-sm">Bill Forgiveness Program</span>
                                    </label>
                                </div>
                            </div>
                        </label>
                    </div>

                    <!-- Option B -->
                    <div class="border border-gray-200 rounded-md p-4">
                        <label class="flex items-start">
                            <input type="radio" name="qualification_option" value="option_b" class="mr-3 mt-1">
                            <div>
                                <span class="font-medium text-gray-900">Option B: Have required documentation</span>
                                <div class="mt-2 space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" name="documentation" value="ebt_award" class="mr-2">
                                        <span class="text-sm">EBT Award Letter for Supplement Income Recipients</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="documentation" value="energy_assistance" class="mr-2">
                                        <span class="text-sm">Energy Assistance Award Letter</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" name="documentation" value="section_8" class="mr-2">
                                        <span class="text-sm">Section 8 Housing Choice Voucher</span>
                                    </label>
                                </div>
                            </div>
                        </label>
                    </div>

                    <!-- Option C -->
                    <div class="border border-gray-200 rounded-md p-4">
                        <label class="flex items-start">
                            <input type="radio" name="qualification_option" value="option_c" class="mr-3 mt-1">
                            <div>
                                <span class="font-medium text-gray-900">Option C: Meet income requirements</span>
                                <div class="mt-2 grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">How many people live in your household?</label>
                                        <input type="number" name="household_size" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">How many people are age 18 or older?</label>
                                        <input type="number" name="adults_count" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                    <div class="md:col-span-2">
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Annual income of ALL household members age 18 and older</label>
                                        <input type="number" name="annual_income" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                </div>
                            </div>
                        </label>
                    </div>

                    <!-- Option D -->
                    <div class="border border-gray-200 rounded-md p-4">
                        <label class="flex items-start">
                            <input type="radio" name="qualification_option" value="option_d" class="mr-3 mt-1">
                            <div>
                                <span class="font-medium text-gray-900">Option D: Multifamily property (2-4 units, 50%+ qualifying tenants)</span>
                                <div class="mt-2">
                                    <p class="text-sm text-gray-600">Property owner must complete tenant qualification table</p>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 4: Authorization -->
        <div class="section-container bg-white shadow sm:rounded-lg overflow-hidden hidden" id="section-4">
            <div class="px-4 py-5 sm:p-6">
                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Section 4: Authorization</h3>
                
                <div class="space-y-6">
                    <div class="p-4 bg-blue-50 border border-blue-200 rounded-md">
                        <p class="text-sm text-blue-800">
                            I am the applicant who has completed this application and request Home Energy Solutions - Income Eligible services 
                            for the property listed in Section 1. I understand, if qualified, the initial visit will be provided at no cost.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">User 2 Name (for signature)</label>
                            <input type="text" name="user2_name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Name of person who will sign">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">User 2 Email</label>
                            <input type="email" name="user2_email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Email to send invitation">
                        </div>
                    </div>

                    <!-- Section 5 Requirements -->
                    <div class="mt-4 p-4 bg-green-50 border border-green-200 rounded-md">
                        <label class="flex items-start">
                            <input type="checkbox" name="requires_section5" value="yes" 
                                   class="mr-3 mt-1 h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded">
                            <div>
                                <span class="font-medium text-green-800">User 2 needs to complete Section 5 (Zero Income Affidavit)</span>
                                <p class="text-sm text-green-700 mt-1">
                                    Check this box if User 2 needs to complete the Zero Income Affidavit based on their qualification status.
                                </p>
                            </div>
                        </label>
                    </div>

                    <div class="border-t pt-4">
                        <h4 class="font-medium text-gray-900 mb-4">Property Owner Information (if different from applicant)</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Property Owner Name</label>
                                <input type="text" name="owner_name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Owner Address</label>
                                <input type="text" name="owner_address" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Owner Telephone</label>
                                <input type="tel" name="owner_telephone" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Owner Email</label>
                                <input type="email" name="owner_email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 5: Zero Income Affidavit -->
        <div class="section-container bg-white shadow sm:rounded-lg overflow-hidden hidden" id="section-5">
            <div class="px-4 py-5 sm:p-6">
                <h3 class="text-lg leading-6 font-medium text-gray-900 mb-4">Section 5: Home Energy Solutions - Income Eligible Zero Income Affidavit</h3>
                
                <div class="space-y-6">
                    <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-md">
                        <p class="text-sm font-medium text-yellow-800 mb-2">Instructions:</p>
                        <p class="text-sm text-yellow-800">
                            Please complete the Zero Income Affidavit only if you qualify with Option C and you have household members over the age of 18 with no income.
                        </p>
                    </div>

                    <!-- Affidavit Statement -->
                    <div class="p-4 bg-blue-50 border border-blue-200 rounded-md">
                        <p class="text-sm text-blue-800 leading-relaxed">
                            I (account holder name), <strong>_______________________________________________________________</strong>, affirm that no adult over the age of 18 years, listed below, who lives in my household, has had any income in the four weeks prior to the date this affidavit is signed. This includes income from employment, a pension, unemployment or worker's compensation, cash assistance from the Connecticut Department of Social Services (including Temporary Family Assistance, State Supplement or the State Administered General Assistance Program), benefits from the Social Security Administration or Veterans Benefits Administration, child support, alimony, interest or any other income source.
                        </p>
                    </div>

                    <!-- Information Note for User 1 -->
                    <div class="p-4 bg-blue-50 border border-blue-200 rounded-md">
                        <h4 class="font-medium text-blue-800 mb-2">📝 For User 1 Information Only</h4>
                        <p class="text-sm text-blue-700">
                            This section provides information about the Zero Income Affidavit that User 2 will need to complete if applicable. 
                            User 2 will fill out all the actual affidavit fields during their signing process.
                        </p>
                    </div>

                    <!-- Account Holder Name (User 2 will complete) -->
                    <div class="p-4 bg-orange-50 border border-orange-200 rounded-md">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Account Holder Name (User 2 will complete)</label>
                        <div class="px-3 py-2 border-2 border-dashed border-orange-300 rounded-md bg-white min-h-[40px] flex items-center text-sm text-orange-600">
                            User 2 will enter the account holder's full name
                        </div>
                        <p class="text-xs text-gray-500 mt-1">This should match the name in the affidavit statement above</p>
                    </div>

                    <!-- Household Members with No Income (User 2 will complete) -->
                    <div class="p-4 bg-orange-50 border border-orange-200 rounded-md">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            List of household members with no income (User 2 will complete)
                        </label>
                        <div class="p-3 bg-gray-50 border border-gray-200 rounded-md mb-2">
                            <p class="text-xs font-medium text-gray-600 mb-1">Note: User 2 will list all people in household who are over age 18 with no income</p>
                            <p class="text-xs text-gray-500">One name per line</p>
                        </div>
                        <div class="px-3 py-2 border-2 border-dashed border-orange-300 rounded-md bg-white min-h-[120px] flex items-center text-sm text-orange-600">
                            User 2 will enter names of household members with no income
                        </div>
                    </div>

                    <!-- Supporting Documentation Notice -->
                    <div class="p-4 bg-orange-50 border border-orange-200 rounded-md">
                        <p class="text-sm text-orange-800">
                            <strong>Important:</strong> I understand that the Home Energy Solutions - Income Eligible program may request supporting documentation regarding my household income. I affirm that the information indicated on this form is accurate.
                        </p>
                    </div>

                    <!-- Signature Section -->
                    <div class="border-t pt-6">
                        <h4 class="font-medium text-gray-900 mb-4">Affidavit Signature (User 2 will complete)</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-orange-50 border border-orange-200 rounded-md">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Signature:</label>
                                <div class="px-3 py-2 border-2 border-dashed border-orange-300 rounded-md bg-white min-h-[40px] flex items-center text-sm text-orange-600">
                                    Digital signature required (User 2)
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Printed Name:</label>
                                <input type="text" name="affidavit_printed_name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Will be filled by User 2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Date:</label>
                                <input type="date" name="affidavit_date" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Telephone:</label>
                                <input type="tel" name="affidavit_telephone" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Will be filled by User 2">
                            </div>
                        </div>
                    </div>

                    <!-- Final Affirmation (User 2 will complete) -->
                    <div class="p-4 bg-orange-50 border border-orange-200 rounded-md">
                        <h4 class="font-medium text-gray-700 mb-2">Final Affirmation (User 2 will complete)</h4>
                        <div class="p-3 bg-white border-2 border-dashed border-orange-300 rounded-md">
                            <p class="text-sm text-orange-600">
                                User 2 will confirm understanding of the Zero Income Affidavit requirements and affirm that all information provided is accurate.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="flex justify-between items-center bg-white shadow sm:rounded-lg px-4 py-3">
            <button type="button" id="prev-btn" class="px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                Previous
            </button>
            <div class="flex space-x-2">
                <button type="button" id="next-btn" class="px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700">
                    Next
                </button>
                <button type="submit" id="submit-btn" class="px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 hidden">
                    Submit Application
                </button>
            </div>
        </div>

        <!-- Hidden field for PDF fields data -->
        <input type="hidden" name="pdf_fields" id="pdf_fields" value="">
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    let currentSection = 1;
    const totalSections = 5;
    
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const submitBtn = document.getElementById('submit-btn');
    const currentSectionSpan = document.getElementById('current-section');
    const progressBar = document.getElementById('progress-bar');
    
    function showSection(sectionNum) {
        // Hide all sections
        document.querySelectorAll('.section-container').forEach(section => {
            section.classList.add('hidden');
        });
        
        // Show current section
        document.getElementById(`section-${sectionNum}`).classList.remove('hidden');
        
        // Update progress
        currentSectionSpan.textContent = sectionNum;
        progressBar.style.width = `${(sectionNum / totalSections) * 100}%`;
        
        // Update button states
        prevBtn.disabled = sectionNum === 1;
        
        if (sectionNum === totalSections) {
            nextBtn.classList.add('hidden');
            submitBtn.classList.remove('hidden');
        } else {
            nextBtn.classList.remove('hidden');
            submitBtn.classList.add('hidden');
        }
    }
    
    nextBtn.addEventListener('click', function() {
        if (currentSection < totalSections) {
            currentSection++;
            showSection(currentSection);
        }
    });
    
    prevBtn.addEventListener('click', function() {
        if (currentSection > 1) {
            currentSection--;
            showSection(currentSection);
        }
    });
    
    // Form submission
    document.getElementById('user1Form').addEventListener('submit', function(e) {
        // Collect all form data and structure it
        const formData = new FormData(this);
        const formObject = {};
        
        for (let [key, value] of formData.entries()) {
            formObject[key] = value;
        }
        
        // Set the PDF fields data (empty for now, will be populated by field mapping)
        document.getElementById('pdf_fields').value = JSON.stringify([]);
        
        console.log('Form submitted with data:', formObject);
    });
    
    // Initialize first section
    showSection(1);
});
</script>
{% endblock %}